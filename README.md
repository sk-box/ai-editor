# YAE (Young AI Editor) - AI編集者チャットボット

10代向けメディア「ワカモノリサーチ」の記事作成を支援するAI編集者チャットボットプロトタイプ

## 📋 概要

アンケート結果から10代向けの記事を生成し、AI編集者が品質評価・改善提案を行うStreamlitベースのマルチページアプリケーション。

### 主な機能

**3つの独立したページで、柔軟なワークフローを実現：**

1. **📝 記事生成ページ（ライター機能）**
   - アンケートデータから要約・構成・本文を自動生成
   - タイトル候補を複数提示
   - サンプルデータまたは手動入力に対応

2. **⭐ 記事評価ページ（編集者評価機能）**
   - 8軸で品質スコアリング（10代自然さ、わかりやすさ、構成、偏り・断定、倫理・配慮、SEO基礎、ブランド整合、データ整合性）
   - 具体的な改善提案を表示
   - **途中から開始可能**: 既存の記事を直接貼り付けて評価できる

3. **✏️ 記事改善ページ（編集者チャット機能）**
   - 対話形式で記事をブラッシュアップ
   - 修正履歴の管理
   - Markdown形式でダウンロード
   - **途中から開始可能**: 既存の記事を直接貼り付けて改善できる

## 🚀 セットアップ

### 前提条件

- Python 3.10以上
- [uv](https://github.com/astral-sh/uv) (推奨) または pip
- OpenAI APIキー

### インストール手順

#### 1. リポジトリのクローンまたはダウンロード

```bash
cd wakamono
```

#### 2. 依存関係のインストール（uvを使用）

```bash
# uvがインストールされていない場合
# Windows (PowerShell)
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"

# macOS/Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# uvで依存関係をインストール
uv sync
```

または、pipを使う場合：

```bash
pip install streamlit openai python-dotenv
```

#### 3. 環境変数の設定

`.env`ファイルを作成し、OpenAI APIキーを設定：

```bash
# .env.exampleをコピー
cp .env.example .env

# .envファイルを編集してAPIキーを設定
# OPENAI_API_KEY=your_openai_api_key_here
```

## 📖 使い方

### アプリの起動

```bash
# uvを使う場合
uv run streamlit run app.py

# pipを使った場合
streamlit run app.py
```

ブラウザで `http://localhost:8501` が自動で開きます。

### 基本的なワークフロー

#### パターン1: 一連の流れで使う（推奨）

```
1. 📝 記事生成ページ
   ↓ アンケートデータを入力 → 記事を生成

2. ⭐ 記事評価ページ
   ↓ AI編集者が8軸で評価 → 改善提案を確認

3. ✏️ 記事改善ページ
   ↓ チャットで対話 → 記事をブラッシュアップ

4. ✅ 完成
   → Markdownでダウンロード
```

#### パターン2: 途中のステップから始める

**既存の記事を評価したい場合:**
1. ⭐ 記事評価ページに直接アクセス
2. 「記事を直接入力する」ボタンをクリック
3. 記事本文を貼り付けて評価を開始

**既存の記事を改善したい場合:**
1. ✏️ 記事改善ページに直接アクセス
2. 「記事を直接入力」ボタンをクリック
3. 記事本文を貼り付けてチャットで改善

### 記事改善時のチャット例

```
ユーザー: "タイトルをもっとキャッチーにして"
AI編集者: [修正案を3つ提示]

ユーザー: "自由回答をもう2つ追加して"
AI編集者: [追加された記事を表示]

ユーザー: "第2段落をもっと簡潔にして"
AI編集者: [修正案を提示]
```

## 📁 ファイル構成

```
wakamono/
├── app.py                      # ホームページ（ダッシュボード）
├── pages/                      # マルチページアプリのページ
│   ├── 1_📝_記事生成.py       # ライター機能
│   ├── 2_⭐_記事評価.py       # 編集者評価機能
│   └── 3_✏️_記事改善.py       # 編集者チャット機能
├── prompts.py                  # 各ページ用のプロンプト
│   ├── SYSTEM_PROMPT          # 編集者チャット用
│   ├── WRITER_PROMPT          # 記事生成用
│   └── EVALUATOR_PROMPT       # 記事評価用
├── pyproject.toml              # uv用の依存関係定義
├── .env.example                # 環境変数のサンプル
├── .env                        # 環境変数（要作成、gitignore対象）
├── enquete/                    # サンプルアンケートデータ
│   ├── survey_data_magazine.md
│   └── survey_data_autumn.md
├── prompt_beta.md              # AI編集者プロンプトの元設計
├── prototype_design.md         # プロトタイプ設計書
└── README.md                   # このファイル
```

## 🎯 使用例

### シナリオ1: 新規記事を一から作成

1. **📝 記事生成ページ**
   - サンプルデータ「紙の雑誌購入調査」を選択
   - 「記事を生成」ボタンをクリック
   - → タイトル案3つ、要約、本文草稿が生成される

2. **⭐ 記事評価ページ**
   - 自動で記事が表示される
   - 「記事を評価」ボタンをクリック
   - → 8軸スコア、強み・弱み、改善提案が表示される

3. **✏️ 記事改善ページ**
   - チャットで「タイトルをもっとキャッチーにして」
   - → AI編集者が修正案を提示
   - チャットで「自由回答をもう2つ追加して」
   - → 記事が更新される

### シナリオ2: 既存記事を評価・改善

1. **⭐ 記事評価ページに直接アクセス**
   - 「記事を直接入力する」をクリック
   - 既存の記事本文を貼り付け
   - 「保存して評価を開始」をクリック
   - → 即座に評価結果が表示される

2. **✏️ 記事改善ページで修正**
   - 評価結果を参考に、チャットで改善指示
   - → 対話しながら記事をブラッシュアップ
   - Markdownでダウンロード

## ⚙️ カスタマイズ

### プロンプトの調整

`prompts.py`で3種類のプロンプトを編集できます：

1. **WRITER_PROMPT** - 記事生成ページで使用
   - 記事の構成、文体、出力形式を調整

2. **EVALUATOR_PROMPT** - 記事評価ページで使用
   - 評価軸、スコアリング基準を調整

3. **SYSTEM_PROMPT** - 記事改善ページで使用
   - チャット時の振る舞い、提案スタイルを調整

### モデルの変更

各ページのファイルでOpenAIモデルを変更できます：

```python
# 記事生成ページ (1_📝_記事生成.py 156行目)
model="gpt-4o-mini",  # → "gpt-4o" に変更でより高品質

# 記事評価ページ (2_⭐_記事評価.py)
model="gpt-4o-mini",  # → "gpt-4o" に変更でより高品質

# 記事改善ページ (3_✏️_記事改善.py)
model="gpt-4o-mini",  # → "gpt-4o" に変更でより高品質
```

## 📊 サンプルデータ

`enquete/` フォルダに2つのサンプルアンケートデータが含まれています：

1. `survey_data_magazine.md` - 紙の雑誌購入調査
2. `survey_data_autumn.md` - 「●●の秋」調査

## 🌐 Streamlit Cloudへのデプロイ

### デプロイ手順

1. **GitHubリポジトリの準備**
   - このリポジトリをフォークまたはクローン
   - 必要なファイルが含まれていることを確認：
     - `requirements.txt` または `pyproject.toml`
     - `.streamlit/config.toml`

2. **Streamlit Cloudでアプリを作成**
   - [Streamlit Cloud](https://share.streamlit.io/) にアクセス
   - 「New app」をクリック
   - リポジトリを選択: `sk-box/ai-editor`
   - ブランチ: `main`
   - メインファイル: `app.py`

3. **環境変数（Secrets）の設定**
   - Streamlit Cloudのアプリ設定で「Settings」→「Secrets」を開く
   - 以下の形式で追加：

   ```toml
   OPENAI_API_KEY = "your-openai-api-key-here"
   ```

4. **デプロイ**
   - 「Deploy!」ボタンをクリック
   - 数分でデプロイが完了し、URLが発行されます

### デプロイ後の確認

- アプリが正常に起動するか確認
- 記事生成・評価・改善の各ページが動作するか確認
- OpenAI APIキーが正しく設定されているか確認

## 🔧 トラブルシューティング

### APIキーエラー

```
⚠️ OPENAI_API_KEYが設定されていません
```

→ `.env`ファイルに正しいAPIキーが設定されているか確認

### サンプルデータが表示されない

→ `enquete/`フォルダが存在し、`.md`ファイルが含まれているか確認

### ストリーミングが表示されない

→ ブラウザをリロード、またはStreamlitのキャッシュをクリア（`c`キー → `Clear cache`）

## 📝 ライセンス

このプロトタイプは株式会社ワカモノリサーチ向けに開発されました。

## 🙋 サポート

質問や問題がある場合は、開発チームにお問い合わせください。
